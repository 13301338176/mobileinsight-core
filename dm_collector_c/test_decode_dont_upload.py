from mobile_insight.monitor.dm_collector import dm_collector_c
from hdlc_frame import *
from mobile_insight.monitor.dm_collector.dm_endec import *
import binascii

tests = [
        # # CDMA Paging Channel Message Extended CDMA Channel List Msg
        # "190019000710E50B60E22C0DD1000D1B720A6064258C80143AFBA3",

        # # 1xEV Signaling Control Channel Broadcast Sync Msg
        # "200020007C102128AD2ADB14D10001E1000400F6BF00FFFF010B00405C89CCFA4606",

        # # WCDMA_CELL_ID
        # "2c002c002741b4008aef9740ce0040100000211100000f5660030000070030070301000401002cd90000ba000000",
        # "2c002c0027419203b0a48540ce00c224000052260000fda3fa02d0000700801f0301000401003ffd00003c000000",
        # # WCDMA_SIGNALLING_MESSAGES UL_CCCH
        # "200020002F41BA017FA40EDECD000000100039A99DCF8C310A086C96100B54B773C8",
        # # WCDMA_SIGNALLING_MESSAGES UL_DCCH
        # "4c004C002F41CC00459D0EDECD0001023C004A880000A0005C32AAD506A556A88A4830408001800151B84071CFBE7280E39F7CF501C73EF9E2038E7DF3CF0866B1A812694845F9228D64802981A0",
        # # WCDMA_SIGNALLING_MESSAGES DL_CCCH
        # "810081002F41CB00019D0EDECD000200710030E73533B9F18621410D92C0D80F5AF4782693A78109E0D420002819FD502C698270B9D3C284F0EA3000144CFE681634C1385CE9E24A78B528002A467F340B1A609C2E74F1A53C7A9C00153200018B4A3D03C0090088EE1982780090088F95E4930E0D1EB5ECFE402843FE207303D029E0",
        # # WCDMA_SIGNALLING_MESSAGES DL_DCCH
        # "180018002F41E100E89D0EDECD000302080020871B86097A6E3A",

        # # WCDMA_SIGNALLING_MESSAGES DL_BCCH_BCH
        # #   MIB
        # "2f002f002f414a01b442814bcf0004281f00948e00bf10c424c05aa2fe00a0c850448c466608a8e54a80100a0100000003",
        # #   SIB1
        # "2f002F002F414600D9581EDECD0004281F00844E017FC764B108500B1BA01483078A2BE62AD00000000000000000000000",
        # #   SIB2
        # "2f002F002F417801C08BD00FD10004281F00176E0213061BE0000000000000000000000000000000000000000000000002",
        # #   SIB3
        # "2f002F002F41290029D010DECD0004281F0072EE03760D801F4544FC60005001000011094E000000000000000000000002",
        # #   SIB5 segment 1
        # "2f002F002F414800E9980EDECD0004281F0004625263403AFFFF03FFFC5010F0290C0A8018000C8BF5B15EA0000003F521",
        # #   SIB5 segment 2
        # "2f002F002F414C0009990EDECD0004281F0004A450438C000091E25080500004110018088B958C0318080B00030533000E",
        # #   SIB5 segment 3
        # "2f002F002F414E0019990EDECD0004281F0004C6517CC4300B6D830021844A0585760186AF400000000000000000000002",
        # #   SIB7 & SIB12
        # "2f002F002F41340049581EDECD0004281F00832E2C43B38111D024541A42A38800C0000000000000000000000000000001",
        # #   SIB19
        # "2f002F002F417E029DCA10DECD0004281F0067AE1F3B41A1001694E4947000000000000000000000000000000000000002",
        # #   SchedulingBlock1
        # "2f002F002F418001008CD00FD10004281F0017EE1B468420BDAC0DE4002FA8000000000000000000000000000000000001",

        # # WCDMA_SIGNALLING_MESSAGES DL_PCCH
        # "2e002E002F41412C0982D00FD100062B1E00434E318C85538C377E400000000000000000000000000000000000000000",
        # # # WCDMA_SIGNALLING_MESSAGES EXTENSION_SIB
        # # "1e001E002F418491218CD00FD10009280E004341A10408FCE414704EAE9051C0",

        # # UMTS NAS_GMM State
        # "0f000F00307100005093AE4AD100010503",
        # # UMTS NAS_MM State
        # "0f000F0031710000282FAF4AD100130100",

        # # UMTS NAS OTA
        # "410041003A713002E9EF14A4CD000130000000080850130014D92CBA0C0A53432B371596621E40000819D842561705270A001805F4DADAFD7A3103E5E00432022000E0",
        # "2b002B003A71F40203F614A4CD00001A0000000809805E130014FD413C1924201D1805F4DAD8FD7C32022000B0",

        # # LTE_RRC_OTA_Packet v7 LTE-RRC_PCCH
        # "26002600C0B00000A3894A13CE00070A7100D801B70799390400000000090040012F05EC4E700000",
        # # LTE_RRC_OTA_Packet v2 LTE-RRC_PCCH
        # "22002200c0b00000c3ad2176ce000209a000d801b707390404090040019d056f48800000",
        # # LTE_RRC_OTA_Packet v2 LTE-RRC_DL_DCCH
        # "2D002D00C0B00000C6A4212BCD000209A001D200E308000006140022020516EE933E90E02F67000299422868020880",
        # # LTE_RRC_OTA_Packet v2 LTE-RRC_UL_DCCH
        # "1B001B00C0B00000C8A4212BCD000209A001D200E30800000802001200",
        # # LTE_RRC_OTA_Packet v7 LTE-RRC_BCCH_DL_SCH / SystemInformation
        # "42004200C0B0000020FC1AEDCD00070A7100B900D5020000020C000000250000804D499F848011580A920220040800D209456AAB00203007B763492540811231BC235FD4",
        # "46004600C0B0000020FC1AEDCD00070A7100B900D502000002700000002900010881F5182916943B54003A41F5229A8A992800944419C25001288836A4A00251196FE9C004A22000",
        # # LTE_RRC_OTA_Packet v7 LTE-RRC_UL_CCCH / RRCConnectionRequest
        # "23002300C0B00000BD2CA84AD100070A71004801FC08000007000000000600478EB97EC288",
        # # LTE_RRC_OTA_Packet v8 LTE-RRC_UL_CCCH / RRCConnectionRequest
        # "25002500C0B09D09C2EECB0FD100080A7200D401FC0800000000070000000006005672DC1BA056",
        # # LTE_RRC_OTA_Packet v8 LTE-RRC_BCCH_DL_SCH / SystemInformation
        # "44004400C0B0AE4CEFEECB0FD100080A7200D401FC08000030680240000000250000110B209D88414A300814000613EB108294601028000E6B56210528C02050000800000000",
        # "fb00FB00C0B028BE4DD42C0DD100080A72015B00D921000095280600000000DC00221615A0000010ECAA2002904650A1811524AC5F009A12562840000201881C46846108097276A5C11550A449EB501EDF353B1D470D0D170E423482F09786B697DCDE55D79E39CD0B925EAFAD25169334BD5531ED4FAE8727AF518875E55B9B99917B4C2166219E112D98A29BC52512DBBCBF87404BE328E3B42EB3BF946D9C7CE6EEB67F39F2F21D573070C75E02794D88523E7DF70C3D26275C8B2732FDD18D3EAD12A2F77E9EC75554A567F9E28A7F961F166E74D9A5BEDF1353A6A709DF648462E007D40D613BEC9083A110A77D906E49510C3F0E018332855AFC",

        # # LTE RRC MIB Message v1
        # "15001500C1B000003BECAF4AD10001D801B70758000219",
        # # LTE RRC MIB Message v2
        # "17001700C1B0A47C49C22C0DD100025B00D921000048000219",

        # # LTE RRC Serving Cell Info Log Pkt v2
        # "25002500C2B00000BCEAAF4AD10002D801B707074E1919161284084087040000003601039A0100",
        # # LTE RRC Serving Cell Info Log Pkt v3
        # "29002900C2B0530B71B7931AD10003E400D2940000D29400006464019E1301D61126000000CC0102000000",

        # # LTE_NAS_ESM_Plain_OTA_Incoming_Message v1
        # "1f001F00E2B000004F7C4D13CE00010905005200C93209833401085E04FEFEC553",
        # # LTE_NAS_ESM_Plain_OTA_Outgoing_Message v1
        # "19001900E3B00000507C4D13CE00010905005200CA000000000000",
        # # LTE_NAS_EMM_Plain_OTA_Incoming_Message v1
        # "3e003E00ECB000001C6E4D13CE00010905000749015A49500BF6130014FF5018D01FFD7C54060013001487405702200013130014D92C2305F4BA302390640100",
        # # LTE_NAS_EMM_Plain_OTA_Outgoing_Message v1
        # "14001400EDB00000C5D84913CE0001090500C7010400",

        # # LTE NAS EMM State
        # "1f001F00EEB00000BC2CA84AD10002050000130062010613006201807828EC97EB",
        # "1f001F00EEB000005093AE4AD10002010300130062010613006201807828EC97EB",
        # "1f001F00EEB00000CCA3AF4AD100020600001300620106130062018078A04198EB",
        # "1f001F00EEB0000082EAAF4AD1000201050013001400FFFFFFFFFFFFFFFFFFFFFF",

        # # LTE_LL1_PDSCH_Demapper_Configuration v23
        # "4400440026B10736EEFE4391D10017188A51FFFF350500FF000000000000000000000000000000FF000000000000000000000000000000020000480100080000000000000000",
        # "4400440026B1E57D78FF4391D1001718B053020033050000700000000000000000000000000000007000000000000000000000000000000200003800500B0000800000000000",
        # "4400440026B131B94B3C4491D10017182871BB673045000300000000000000000000000000000003000000000000000000000000000010040000B802540BE803840000000000",
        # "4400440026B1C07CAC687B8FD1001770D304F125300500F0000000000000000000000000000000F0000000000000000000000000000000020000580000080000800000000000",

        # # LTE_ML1_Serving_Cell_Measurement_Result v1
        # "6000600093B10000E49484C7CF000101995119045000B707D80118E914023A85C00818751700DDE559009ED55D00DD555249134D5412255D4C5D17030000F2FFF5FF340037000C000000D0AE0C000A9A190037AB0200690900009A1600002AA10200",
        # # LTE_ML1_Connected_Mode_LTE_Intra_Freq_Meas_Results v3
        # "3000300079B100000C9584C7CF000300000000000000B707D8018C0AE605E6053101310101009A00C904C904420042000000",
        # "5C005C0079B10000E9F684C7CF000300000000000000B707D801200D160616062F012F0102029A00EA04EA040500050000009B00EA04EA042D002D0000009A000000D313000010634B1F000000009B0000003811000030E3701F00000000",
        # LTE_PDCP_DL_SRB_Integrity_Data_PDU v1, TestCase 6
        "54005400A5B02B82C6D5B7D3D10001010000C6014400EC5EF8837A6E51E36DE7CB4E0B490AE24E33D4A88B2B9E31825D687D310BF76E07070100214008000800452C00000000FB7CCE18FB7CCE180034022018CE7CFB",
        # LTE_PDCP_UL_SRB_Integrity_Data_PDU v1, TestCase 8
        "50005000B5B01016C8D5B7D3D10001016847C701400064FE427B18982DE38D4F22486A8F44706BA559F4A3C9B19B45EFF151EB0E83B7030201002140070007000040010000008EE304B5012C00B504E38E00"
        # LTE_MAC_Configure
        "FC01FC0160B0ACAFCCD5B7D3D1000106B7D300010800000DB0010101080000281CB102011000011400140000004001C44D0203021C0098FF0220280A200012000417000200030A46020500050A02040148010001020304000000000000000000000000000000000000000000000000000000000302FFFF0300000000000310000903C012000004FFFF09009CFF630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000039010D01680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        # LTE_MAC_Configure
        "FC01FC0160B09E118B6A575ED2000106A82D0001080000073D0A01010800FFFF083402011000000000FFFF0000000A15B3C303021C0092FF0440400A400000000017000C00040A6C000600040AD504014801000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007E880D01680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C3E1E1",
        # LTE_MAC_UL_Transport_Block
        "6000600064B05057406C575ED20001011C8A08015000040400000B61000215000203073D210221431F000500250B9100008C000104053E1F0000000100450B69000257000103073D210221091F000300710B6900014D000203053D22171F00A69F29",
        # LTE_MAC_DL_Transport_Block
        "9C009C0063B0239D946A575ED2000101000007028C000400080501000020000000002000800F95BF6486C1141A8200200048041258BF52ABCAF7202F08520A311758800508050000001C000000001C684C424C13FD416B29069206A590040C21611308D848C2A00000001E1008050100000D000000000D0009113A92E722AE2A445718802008050100000D000000000D000C05047E104807D03060000081"
        ]
from xml.dom import minidom
for b in tests:
    dm_collector_c.feed_binary(HdlcFrame(binascii.a2b_hex("1000" + b)).binary())
    while True:
        l = dm_collector_c.receive_log_packet()
        if l:
            DMLogPacket.init({})
            s = DMLogPacket(l).decode_xml().replace("\n", "")
            print minidom.parseString(s).toprettyxml(" ")
            # s = DMLogPacket(l).decode_json()
            # print s
        else:
            break
